<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <record id="crm_tracking_campaign_form" model="ir.ui.view">
            <field name="name">crm.tracking.campaign.form.inherited.sale_campaign</field>
            <field name="model">crm.tracking.campaign</field>
            <field name="inherit_id" ref="crm.crm_tracking_campaign_form" />
            <field name="arch" type="xml">
                <field name="section_id" position="after">
                    <field name="date_start" />
                    <field name="date_stop" />
                    <field name="website_url" invisible="1"/>
                    <field name="website_published" widget="website_button"/>
                    <field name="pricelist" />
                    <field name="reseller_pricelist" />
                    <field name="product_ids" widget="many2many_tags" />
                    <field name="website_description" />
                </field>
            </field>
        </record>
        <record id="crm_tracking_campaign_act_form" model="ir.actions.act_window">
            <field name="name">Campaigns Form</field>
            <field name="res_model">crm.tracking.campaign</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="crm.crm_tracking_campaign_form"/>
        </record>
        <record id="product_public_category_form_view" model="ir.ui.view">
            <field name="name">product.public.category.form.inherited.sale_campaign</field>
            <field name="model">product.public.category</field>
            <field name="inherit_id" ref="website_sale.product_public_category_form_view" />
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="mobile_icon" />
                </field>
            </field>
        </record>
        <template id="products_list" inherit_id="website_sale.products" name="Products List">
            <xpath expr="//t[@t-set='additional_title']" position="replace">
                <t t-if="campaign">
                    <t t-set="additional_title">Campaign</t>
                </t>
                <t t-if="not campaign">
                    <t t-set="additional_title">Shop</t>
                </t>
            </xpath>
            <xpath expr="//div[@class='products_pager']/div[@class='row']/t[@t-call='website.pager']" position="replace">
                <t t-if="campaign">
                </t>
                <t t-if="not campaign">
                    <t t-call="website.pager"/>
                </t>
            </xpath>
            <xpath expr="//div[@class='products_pager']/t[@t-call='website.pager']" position="replace">
                <t t-if="campaign">
                </t>
                <t t-if="not campaign">
                    <t t-call="website.pager"/>
                </t>
            </xpath>
            <xpath expr="//div[@class='container oe_website_sale']" position="before">
                <t t-if="campaign">
                    <div class="container">
                        <div class="col-sm-offset-8 col-sm-4 mt16" groups="base.group_sale_manager">
                            <t t-call="website.publish_management">
                                <t t-set="object" t-value="campaign"/>
                                <t t-set="publish_edit" t-value="True"/>
                                <t t-set="action" t-value="'sale_campaign.crm_tracking_campaign_act_form'"/>
                            </t>
                        </div>
                        <div t-field="campaign.website_description" />
                    </div>
                </t>
            </xpath>
            <xpath expr="//div[@id='products_grid']" position="before">
                <t t-if="not campaign">
                    <ul class="nav nav-tabs nav-justified hidden-xs">
                        <li t-att-class=" '' if category else 'active' ">
                            <a t-att-href="keep('/shop',category=0)">All Products</a>
                        </li>
                        <t t-foreach="categories" t-as="c">
                            <t t-call="website_sale.categories_recursive" />
                        </t>
                    </ul>
                    <ul class="nav nav-pills hidden-lg hidden-md hidden-sm">
                        <li t-att-class=" '' if category else 'active' ">
                            <a t-att-href="keep('/shop',category=0)"><i class="fa fa-home fa-2"/></a>
                        </li>
                        <t t-foreach="categories" t-as="c">
                            <t t-call="sale_campaign.categories_recursive_mobile" />
                        </t>
                    </ul>
                </t>
            </xpath>
        </template>
        <template id="categories_recursive_mobile" name="Category list On Mobile">
            <li t-att-class="'active' if c.id == int(category or 0) else ''">
                <t t-if="c.mobile_icon">
                    <a t-att-href="keep('/shop/category/' + slug(c), category=0)">
                        <i t-att-class="'%s fa-2x' %(c.mobile_icon)" />
                    </a>
                </t>
                <t t-if="not c.mobile_icon">
                    <a t-att-href="keep('/shop/category/' + slug(c), category=0)" t-field="c.name" />
                </t>
            </li>
            <t t-if="c.child_id">
                <t t-foreach="c.child_id" t-as="c">
                    <t t-call="sale_campaign.categories_recursive_mobile" />
                </t>
            </t>
        </template>
        <template id="products_item" inherit_id="website_sale.products_item" name="Product item">
            <xpath expr="//section/h5" position="after">
                <div class="oe_vertel_product_info">
                    <p class="p_desc" t-field="product.description_sale" />
                </div>
                <p class="text-muted" t-field="product.default_code" />
            </xpath>
            <xpath expr="//div[@itemprop='offers']" position="after">
                <b t-if="product.qty_available &gt; 0.0" class="" style="color: #1CB807;">In stock</b>
                <b t-if="product.qty_available &lt;= 0.0" class="" style="color: #f00;">Not in stock</b>
                <form t-att-action="keep('/shop/cart/update')" class="js_add_cart_variants" t-att-data-attribute_value_ids="product.product_variant_ids.ids" method="POST">
                    <div class="product_shop col-md-12">
                        <input type="hidden" class="product_id" name="product_id" t-att-value="int(product.product_variant_ids[0]) if len(product.product_variant_ids) == 1 else '0'" />
                        <a class="btn btn-default btn-sm" href="#">More info</a>
                        <input type="text" class="oe_p_qty form-control input-sm" data-min="1" name="add_qty" value="1" />
                        <a id="add_to_cart" class="btn btn-primary btn-sm js_check_product a-submit" href="#">Buy</a>
                    </div>
                </form>
            </xpath>
        </template>
        <template id="css_js" inherit_id="website.layout" name="Css Js">
            <xpath expr="//t[@t-call-assets='website.assets_frontend']" position="after">
                <link href="/sale_campaign/static/src/css/sale_campaign.css" rel="stylesheet" type="text/css" />
            </xpath>
        </template>
    </data>
</openerp>
